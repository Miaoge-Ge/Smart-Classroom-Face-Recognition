{% extends "base.html" %}

{% block content %}
<h2>ğŸ•’ è€ƒå‹¤è®°å½•</h2>
<hr>

<div class="row mb-3">
    <div class="col-md-8">
        <form class="d-flex" method="get" action="/history">
            <select class="form-select me-2" name="college" style="width: 200px;">
                <option value="">æ‰€æœ‰å­¦é™¢</option>
                {% for c in colleges %}
                <option value="{{ c }}" {% if current_college == c %}selected{% endif %}>{{ c }}</option>
                {% endfor %}
            </select>
            <input class="form-control me-2" type="search" name="search_query" placeholder="è¾“å…¥å§“åæˆ–å­¦å·" value="{{ current_search or '' }}" aria-label="Search" style="width: 200px;">
            <button class="btn btn-outline-primary" type="submit">ç­›é€‰</button>
            {% if current_college or current_search %}
            <a href="/history" class="btn btn-outline-secondary ms-2">é‡ç½®</a>
            {% endif %}
        </form>
    </div>
    <div class="col-md-4 text-end">
        <a href="/api/export_attendance?{% if current_college %}college={{ current_college }}&{% endif %}{% if current_search %}search_query={{ current_search }}{% endif %}" class="btn btn-success">
            ğŸ“¤ å¯¼å‡º CSV
        </a>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>å§“å</th>
                    <th>å­¦å·</th>
                    <th>å­¦é™¢</th>
                    <th>ç­çº§</th>
                    <th>ç­¾åˆ°æ—¶é—´</th>
                    <th>çŠ¶æ€</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td>{{ record.name }}</td>
                    <td>{{ record.student_id }}</td>
                    <td>{{ record.college }}</td>
                    <td>{{ record.class_name }}</td>
                    <td>{{ record.timestamp }}</td>
                    <td><span class="badge bg-success">{{ record.status }}</span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
